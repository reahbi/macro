# 📘 Excel Macro Automation 사용자 가이드

## 🎯 이 프로그램은 무엇인가요?

Excel Macro Automation은 **Excel 데이터를 활용하여 반복적인 화면 작업을 자동화**하는 프로그램입니다.

### 주요 용도
- 📊 **Excel 데이터 기반 반복 작업**: 고객 명단, 환자 정보 등을 순차적으로 처리
- 🖱️ **화면 자동 클릭**: 정해진 위치를 자동으로 클릭
- ⌨️ **자동 입력**: Excel의 데이터를 프로그램에 자동 입력
- 🔍 **텍스트/이미지 인식**: 화면에서 특정 텍스트나 이미지를 찾아 작업

---

## 🚀 빠른 시작 가이드

### 1️⃣ 프로그램 실행
```bash
RUN_AUTO_VENV.bat 더블클릭
```

### 2️⃣ 첫 실행 시 OCR 설치
- 텍스트 검색 기능을 위해 필수로 설치해야 합니다
- "예" 버튼을 클릭하면 자동으로 설치됩니다 (5-10분 소요)

---

## 📋 프로그램 사용 단계

### 1단계: Excel 파일 준비 및 불러오기

#### Excel 파일 형식 예시:
| 이름 | 주민번호 | 전화번호 | 주소 | 비고 |
|------|----------|----------|------|------|
| 홍길동 | 800101-1234567 | 010-1234-5678 | 서울시 강남구 | 신규 |
| 김철수 | 900202-2345678 | 010-2345-6789 | 서울시 서초구 | 기존 |

#### 파일 불러오기:
1. **"Excel 데이터"** 탭 클릭
2. **"파일 선택"** 버튼 클릭 또는 드래그&드롭
3. 시트 선택 (보통 "Sheet1")
4. 데이터 미리보기 확인

---

### 2단계: 매크로 만들기

#### "매크로 편집" 탭에서:

1. **왼쪽 도구 상자**에서 필요한 동작을 선택
2. **오른쪽 작업 영역**으로 드래그&드롭

#### 🛠️ 사용 가능한 동작들:

##### 🖱️ **마우스 클릭**
- 화면의 특정 위치를 클릭
- 사용법: 
  1. 도구 상자에서 "마우스 클릭" 드래그
  2. 더블클릭하여 설정
  3. "위치 선택" 버튼 클릭 → 원하는 위치 클릭

##### ⌨️ **텍스트 입력**
- Excel 데이터나 고정 텍스트 입력
- 사용법:
  1. "텍스트 입력" 드래그
  2. 입력 방식 선택:
     - **고정 텍스트**: 항상 같은 내용 입력
     - **Excel 데이터**: ${열이름} 형식으로 입력
     - 예: ${이름}, ${주민번호}, ${전화번호}

##### 🔤 **텍스트 검색**
- 화면에서 특정 텍스트를 찾아 클릭
- 사용법:
  1. "텍스트 검색" 드래그
  2. 찾을 텍스트 입력 (예: "확인", "저장", "다음")
  3. 검색 영역 설정 (선택사항)

##### ⏱️ **대기**
- 다음 동작까지 잠시 대기
- 사용법:
  1. "대기" 드래그
  2. 대기 시간 설정 (초 단위)

##### 🔄 **반복문**
- Excel 데이터 각 행에 대해 반복
- 사용법:
  1. "반복문" 드래그
  2. 반복할 동작들을 반복문 안에 배치

---

### 3단계: 매크로 실행

#### "실행" 탭에서:

1. **실행 옵션 설정**:
   - 실행 속도: 느림/보통/빠름
   - 오류 시 처리: 계속/중지

2. **실행 버튼 클릭**:
   - ▶️ 실행: 매크로 시작
   - ⏸️ 일시정지: 잠시 멈춤
   - ⏹️ 중지: 완전히 중단

3. **실행 결과 확인**:
   - 각 단계별 진행 상황 표시
   - 오류 발생 시 상세 내용 표시
   - 실행 로그 자동 저장 (CSV 파일)

---

## 💡 실제 사용 예시

### 예시 1: 고객 정보 일괄 입력

**상황**: 100명의 신규 고객을 CRM 시스템에 등록

**매크로 구성**:
1. 🔄 반복문 시작 (Excel 각 행에 대해)
2. 🖱️ "신규 등록" 버튼 클릭
3. ⏱️ 1초 대기
4. 🖱️ "이름" 입력란 클릭
5. ⌨️ ${이름} 입력
6. 🖱️ "전화번호" 입력란 클릭
7. ⌨️ ${전화번호} 입력
8. 🖱️ "저장" 버튼 클릭
9. ⏱️ 2초 대기
10. 🔄 반복문 종료

### 예시 2: 검사 결과 조회 및 출력

**상황**: 환자 명단에서 각 환자의 검사 결과 조회 및 출력

**매크로 구성**:
1. 🔄 반복문 시작
2. 🔤 "검색" 텍스트 찾아서 클릭
3. ⌨️ ${환자번호} 입력
4. ⌨️ Enter 키 입력
5. ⏱️ 3초 대기 (결과 로딩)
6. 🔤 "출력" 텍스트 찾아서 클릭
7. ⏱️ 2초 대기
8. 🔤 "확인" 텍스트 찾아서 클릭
9. 🔄 반복문 종료

---

## ⚙️ 고급 기능

### 조건문 사용
- 특정 조건에 따라 다른 동작 수행
- 예: ${구분} == "신규"인 경우만 특별 처리

### 이미지 인식
- 텍스트가 아닌 아이콘이나 이미지 클릭
- 화면 캡처 후 찾을 이미지 지정

### 단축키 사용
- Ctrl+C, Ctrl+V 등 키보드 단축키 실행
- Alt+Tab으로 프로그램 전환

---

## 🔧 문제 해결

### "텍스트를 찾을 수 없습니다"
- 텍스트가 정확한지 확인
- 검색 영역을 더 크게 설정
- 대기 시간을 늘려보기

### "클릭 위치가 틀립니다"
- 화면 해상도나 배율 확인
- 프로그램 창 크기가 변경되지 않았는지 확인
- 위치 재설정

### 실행 속도가 너무 빠름/느림
- 실행 옵션에서 속도 조절
- 각 단계별 대기 시간 조정

---

## 💾 매크로 저장 및 불러오기

### 저장하기
1. 매크로 편집 완료 후 "저장" 버튼 클릭
2. 파일명 입력 (예: "고객등록_매크로.emf")
3. 암호 설정 (선택사항)

### 불러오기
1. "불러오기" 버튼 클릭
2. 저장된 .emf 파일 선택
3. 암호 입력 (설정한 경우)

---

## 📊 실행 로그 활용

모든 실행 내역은 자동으로 CSV 파일로 저장됩니다.

**로그 내용**:
- 실행 시간
- 처리된 데이터
- 각 단계별 결과
- 오류 발생 내역

**위치**: `logs/실행날짜_시간.csv`

---

## 🚨 주의사항

1. **화면 변경 금지**: 매크로 실행 중 화면을 변경하지 마세요
2. **프로그램 위치 고정**: 대상 프로그램의 위치와 크기를 고정하세요
3. **데이터 백업**: 중요한 작업 전 반드시 데이터를 백업하세요
4. **테스트 실행**: 전체 실행 전 몇 개 데이터로 테스트하세요

---

## 📞 추가 도움말

- **단축키**: 
  - F5: 매크로 실행/중지
  - ESC: 긴급 중지
  - Ctrl+S: 매크로 저장

- **팁**:
  - 복잡한 작업은 여러 개의 작은 매크로로 나누기
  - 자주 사용하는 매크로는 템플릿으로 저장
  - 실행 전 항상 첫 번째 데이터로 테스트

---

이 가이드가 Excel Macro Automation 사용에 도움이 되기를 바랍니다! 🎉