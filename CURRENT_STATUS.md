# Excel Macro Automation - 현재 구현 상태

## 🚀 실행 방법

```bash
# 1. 가상환경 활성화
source venv/bin/activate

# 2. GUI 실행
python run_gui.py
# 또는
./start_gui.sh
```

## ✅ 구현 완료된 기능

### 1. Excel 연동 (T-002) ✓
- Excel 파일 불러오기 (.xlsx, .xls, .csv)
- 시트 선택 및 전환
- 데이터 미리보기 (처음 100행)
- 열 매핑 설정
- 상태 열 자동 추가/업데이트

### 2. 매크로 에디터 (T-003) ✓
- **드래그 앤 드롭** 방식의 직관적인 UI
- 단계 추가/삭제/순서 변경
- 각 단계별 상세 설정
- 실시간 매크로 미리보기

### 3. 지원되는 매크로 단계

#### 마우스 동작
- **마우스 클릭** 🖱️
  - 좌표 지정, 클릭 횟수, 버튼 선택
- **마우스 이동** ↗️
  - 좌표로 이동, 이동 시간 설정

#### 키보드 동작
- **텍스트 입력** ⌨️
  - 일반 텍스트 입력
  - Excel 변수 바인딩 ({{변수명}})
- **단축키** ⌘
  - Ctrl, Alt, Shift 조합키 지원

#### 대기 동작
- **시간 대기** ⏱️
  - 초 단위 대기 시간 설정
- **이미지 대기** 🖼️ (T-005) ✓
  - 화면에서 이미지가 나타날 때까지 대기
  - ROI(관심 영역) 지정 가능
  - 신뢰도 설정

#### 화면 인식 (T-005, T-006) ✓
- **이미지 검색** 🔍
  - OpenCV 기반 고급 이미지 매칭
  - DPI 스케일링 자동 처리
  - 멀티 모니터 지원
- **텍스트 검색** 🔤
  - EasyOCR 기반 한국어/영어 텍스트 인식
  - Excel 열 데이터와 연동
  - 찾은 텍스트 자동 클릭

#### 제어 구조 (T-007) 🚧
- **조건문** ❓ (개발 중)
- **반복문** 🔄 (예정)

### 4. 매크로 실행 엔진 (T-004) ✓
- Excel 행 단위 순차 실행
- 일시정지/재개 (F9)
- 강제 종료 (ESC)
- 실행 로그 기록
- 진행률 표시

### 5. 매크로 저장/불러오기 (T-008) ✓
- JSON 형식 저장
- 암호화 저장 옵션
- 자동 백업
- 템플릿 제공

## 🔧 기술 스택

- **언어**: Python 3.10
- **GUI**: PyQt5
- **자동화**: PyAutoGUI
- **이미지 처리**: OpenCV
- **OCR**: EasyOCR
- **Excel**: pandas, openpyxl

## 📁 프로젝트 구조

```
macro/
├── src/
│   ├── automation/     # 실행 엔진
│   ├── config/         # 설정 관리
│   ├── core/           # 핵심 비즈니스 로직
│   ├── excel/          # Excel 처리
│   ├── logger/         # 로깅
│   ├── ui/             # 사용자 인터페이스
│   │   ├── dialogs/    # 다이얼로그
│   │   └── widgets/    # 위젯 컴포넌트
│   ├── utils/          # 유틸리티
│   └── vision/         # 이미지/텍스트 인식
├── venv/               # 가상환경
├── demo_data.xlsx      # 테스트용 Excel 데이터
└── run_gui.py          # GUI 실행 스크립트
```

## 🎯 다음 단계 (개발 중)

- [ ] T-007: 조건문 UI 및 실행 로직
- [ ] T-009: 실행 로깅 개선
- [ ] T-010: 매크로 테스트 시뮬레이터
- [ ] T-011: 다크 모드
- [ ] T-012: 다국어 지원

## 💡 사용 팁

1. **Excel 데이터 준비**
   - 첫 번째 행은 열 제목으로 사용
   - '상태' 열은 자동으로 추가됨

2. **매크로 만들기**
   - 왼쪽 팔레트에서 단계를 드래그하여 추가
   - 각 단계를 클릭하여 상세 설정
   - {{변수명}} 형식으로 Excel 데이터 참조

3. **이미지/텍스트 검색**
   - ROI 선택 시 화면이 반투명하게 변함
   - 드래그하여 검색 영역 지정
   - 테스트 버튼으로 미리 확인 가능

## 🐛 알려진 이슈

- WSL 환경에서 tkinter 경고 (무시 가능)
- High DPI 디스플레이에서 좌표 보정 필요할 수 있음

## 📞 문의

문제가 발생하거나 기능 제안이 있으시면 이슈를 등록해주세요.