# 🔄 Excel Macro Automation 실무 활용 예제

## 📋 목차
1. [의료 기관 활용 예제](#의료-기관-활용-예제)
2. [일반 사무 활용 예제](#일반-사무-활용-예제)
3. [고객 관리 활용 예제](#고객-관리-활용-예제)
4. [데이터 수집 활용 예제](#데이터-수집-활용-예제)

---

## 🏥 의료 기관 활용 예제

### 1. 건강검진 결과 일괄 입력

**시나리오**: 100명의 검진 결과를 EMR 시스템에 입력

**Excel 데이터 구조**:
| 환자번호 | 이름 | 주민번호 | 혈압 | 혈당 | 콜레스테롤 | 판정 |
|---------|------|----------|------|------|-----------|------|
| P001 | 홍길동 | 700101-1****** | 120/80 | 95 | 180 | 정상 |
| P002 | 김영희 | 850202-2****** | 130/85 | 110 | 200 | 주의 |

**매크로 구성**:
```
1. 🔄 Excel 데이터 반복 시작
2. 🔤 "환자조회" 텍스트 찾아 클릭
3. ⌨️ ${환자번호} 입력
4. ⌨️ [Enter] 키
5. ⏱️ 2초 대기 (환자 정보 로딩)
6. 🔤 "검진결과입력" 텍스트 찾아 클릭
7. 🖱️ 혈압 입력란 클릭
8. ⌨️ ${혈압} 입력
9. 🖱️ 혈당 입력란 클릭
10. ⌨️ ${혈당} 입력
11. 🖱️ 콜레스테롤 입력란 클릭
12. ⌨️ ${콜레스테롤} 입력
13. 🖱️ 판정 선택란 클릭
14. 🔤 ${판정} 텍스트 찾아 클릭
15. 🔤 "저장" 버튼 클릭
16. ⏱️ 1초 대기
17. 🔤 "확인" 팝업 클릭
18. 🔄 반복 종료
```

### 2. 처방전 일괄 발행

**시나리오**: 만성질환자 정기 처방전 발행

**Excel 데이터 구조**:
| 환자번호 | 이름 | 약품코드1 | 용량1 | 약품코드2 | 용량2 | 일수 |
|---------|------|----------|-------|----------|-------|------|
| P101 | 박민수 | MED001 | 1T | MED002 | 2T | 30 |

**매크로 구성**:
```
1. 🔄 처방 대상자 반복 시작
2. 🔤 "처방" 메뉴 클릭
3. ⌨️ ${환자번호} 입력 후 조회
4. ⏱️ 1초 대기
5. 🔤 "약품추가" 버튼 클릭
6. ⌨️ ${약품코드1} 입력
7. ⌨️ [Tab] 키
8. ⌨️ ${용량1} 입력
9. 🔤 "추가" 버튼 클릭
10. ❓ 조건: ${약품코드2}가 있으면
    - 5~9번 과정 반복
11. 🖱️ 처방일수 입력란 클릭
12. ⌨️ ${일수} 입력
13. 🔤 "처방저장" 클릭
14. 📷 처방전 화면 캡처
15. 🔤 "출력" 클릭
16. 🔄 반복 종료
```

---

## 🏢 일반 사무 활용 예제

### 3. 전자결재 일괄 상신

**시나리오**: 여러 건의 품의서를 그룹웨어에 일괄 상신

**Excel 데이터 구조**:
| 제목 | 금액 | 내용 | 결재선1 | 결재선2 | 첨부파일 |
|------|------|------|--------|--------|---------|
| 사무용품 구매 | 500,000 | 프린터 토너 외 | 김과장 | 박부장 | C:\품의\견적서1.pdf |

**매크로 구성**:
```
1. 🔄 품의서 목록 반복 시작
2. 🔤 "새결재" 버튼 클릭
3. 🔤 "일반품의" 양식 선택
4. ⏱️ 2초 대기 (양식 로딩)
5. 🖱️ 제목 입력란 클릭
6. ⌨️ ${제목} 입력
7. 🖱️ 금액 입력란 클릭
8. ⌨️ ${금액} 입력
9. 🖱️ 내용 입력란 클릭
10. ⌨️ ${내용} 입력
11. 🔤 "결재선지정" 클릭
12. 🔤 ${결재선1} 검색 후 추가
13. 🔤 ${결재선2} 검색 후 추가
14. 🔤 "확인" 클릭
15. ❓ 조건: ${첨부파일}이 있으면
    - 🔤 "파일첨부" 클릭
    - ⌨️ ${첨부파일} 경로 입력
    - 🔤 "열기" 클릭
16. 🔤 "상신" 버튼 클릭
17. 🔤 "확인" 팝업 클릭
18. ⏱️ 3초 대기
19. 🔄 반복 종료
```

### 4. 급여명세서 이메일 발송

**시나리오**: 전 직원 급여명세서 개별 이메일 발송

**Excel 데이터 구조**:
| 사번 | 이름 | 이메일 | 급여명세서경로 |
|------|------|--------|---------------|
| E001 | 홍길동 | hong@company.com | C:\급여\2024-01\E001.pdf |

**매크로 구성**:
```
1. 🔄 직원 목록 반복 시작
2. 🔤 "새메일" 버튼 클릭
3. 🖱️ 받는사람 입력란 클릭
4. ⌨️ ${이메일} 입력
5. 🖱️ 제목 입력란 클릭
6. ⌨️ [2024년 1월] ${이름}님 급여명세서
7. 🖱️ 본문 입력란 클릭
8. ⌨️ 안녕하세요 ${이름}님,\n1월 급여명세서를 첨부합니다.
9. 🔤 "파일첨부" 클릭
10. ⌨️ ${급여명세서경로} 입력
11. 🔤 "열기" 클릭
12. ⏱️ 2초 대기 (첨부 완료)
13. 🔤 "보내기" 클릭
14. ⏱️ 1초 대기
15. 🔄 반복 종료
```

---

## 👥 고객 관리 활용 예제

### 5. CRM 고객 정보 일괄 업데이트

**시나리오**: 고객 연락처 및 등급 정보 대량 업데이트

**Excel 데이터 구조**:
| 고객번호 | 고객명 | 신규전화 | 신규주소 | 등급변경 | 메모 |
|---------|--------|---------|---------|---------|------|
| C1001 | (주)한국 | 02-1234-5678 | 서울시 강남구 | VIP | 2024년 우수고객 |

**매크로 구성**:
```
1. 🔄 고객 목록 반복 시작
2. 🔤 "고객조회" 메뉴 클릭
3. ⌨️ ${고객번호} 입력
4. ⌨️ [Enter] 키
5. ⏱️ 2초 대기 (고객정보 로딩)
6. 🔤 "정보수정" 버튼 클릭
7. ❓ 조건: ${신규전화}가 있으면
    - 🖱️ 전화번호 필드 트리플클릭 (전체선택)
    - ⌨️ ${신규전화} 입력
8. ❓ 조건: ${신규주소}가 있으면
    - 🖱️ 주소 필드 클릭
    - ⌨️ [Ctrl+A] (전체선택)
    - ⌨️ ${신규주소} 입력
9. ❓ 조건: ${등급변경}이 있으면
    - 🖱️ 등급 드롭다운 클릭
    - 🔤 ${등급변경} 선택
10. 🖱️ 메모 필드 클릭
11. ⌨️ [End] 키 (끝으로 이동)
12. ⌨️ \n${메모} 입력
13. 🔤 "저장" 버튼 클릭
14. 🔤 "확인" 팝업 클릭
15. 🔄 반복 종료
```

---

## 📊 데이터 수집 활용 예제

### 6. 웹사이트 가격 정보 수집

**시나리오**: 경쟁사 제품 가격 모니터링

**Excel 데이터 구조**:
| 제품코드 | 제품명 | 검색키워드 | 수집일자 | 가격 |
|---------|--------|-----------|---------|------|
| P001 | 노트북A | 삼성 갤럭시북3 | (자동입력) | (자동입력) |

**매크로 구성**:
```
1. 🔄 제품 목록 반복 시작
2. 🔤 브라우저 주소창 클릭
3. ⌨️ www.shopping-site.com 입력
4. ⌨️ [Enter] 키
5. ⏱️ 3초 대기 (페이지 로딩)
6. 🔤 "검색" 입력란 클릭
7. ⌨️ ${검색키워드} 입력
8. ⌨️ [Enter] 키
9. ⏱️ 2초 대기 (검색결과 로딩)
10. 🖼️ 첫 번째 상품 이미지 대기/클릭
11. ⏱️ 2초 대기
12. 🔤 "현재가" 텍스트 근처 가격 복사
    - 🖱️ 가격 텍스트 드래그
    - ⌨️ [Ctrl+C] 복사
13. 📷 화면 캡처 (증빙용)
14. Excel로 돌아가기
    - ⌨️ [Alt+Tab]
15. 해당 행의 "가격" 열에 붙여넣기
    - ⌨️ [Ctrl+V]
16. 수집일자 입력
    - ⌨️ [Ctrl+;] (오늘 날짜)
17. 🔄 반복 종료
```

### 7. 내부 시스템 데이터 추출

**시나리오**: 여러 부서의 월별 실적 데이터 수집

**Excel 데이터 구조**:
| 부서코드 | 부서명 | 조회월 | 매출액 | 달성률 |
|---------|--------|--------|--------|--------|
| D001 | 영업1팀 | 202401 | (자동수집) | (자동수집) |

**매크로 구성**:
```
1. 🔄 부서 목록 반복 시작
2. 🔤 "실적조회" 메뉴 클릭
3. 🖱️ 부서 선택 드롭다운 클릭
4. 🔤 ${부서명} 선택
5. 🖱️ 조회기간 입력란 클릭
6. ⌨️ ${조회월} 입력
7. 🔤 "조회" 버튼 클릭
8. ⏱️ 5초 대기 (데이터 로딩)
9. 🔤 "Excel 다운로드" 버튼 확인
    - ❓ 버튼이 있으면: 클릭하여 다운로드
    - ❓ 버튼이 없으면: 
        - 화면에서 직접 데이터 복사
        - 매출액 숫자 드래그 → 복사
        - 달성률 숫자 드래그 → 복사
10. Excel로 돌아가서 붙여넣기
11. 📷 조회 화면 캡처 (검증용)
12. 🔄 반복 종료
```

---

## 💡 활용 팁

### 1. 안정성 향상 방법
- 각 클릭 동작 후 충분한 대기 시간 설정
- 텍스트 검색 시 고유한 텍스트 사용
- 중요한 작업 후 화면 캡처로 증거 남기기

### 2. 속도 최적화
- 불필요한 대기 시간 제거
- 키보드 단축키 적극 활용
- 반복문 내 조건문으로 필요한 작업만 수행

### 3. 오류 처리
- 중요 단계마다 화면 확인 로직 추가
- 오류 발생 시 스크린샷 자동 저장
- 실패한 데이터는 별도 표시하여 재처리

### 4. 데이터 검증
- 작업 완료 후 결과 화면 캡처
- 처리 건수와 Excel 데이터 건수 비교
- 로그 파일로 작업 내역 추적

---

이러한 예제들을 참고하여 여러분의 업무에 맞는 자동화 매크로를 만들어보세요! 🚀