# Excel Macro Automation - 애플리케이션 가이드

## 🚀 애플리케이션 실행 방법

### 1. 의존성 확인
```bash
# 이미 설치됨 (pip3 install -r requirements.txt)
# 주요 패키지: PyQt5, pandas, opencv-python, pyautogui, easyocr
```

### 2. 애플리케이션 실행
```bash
# 프로젝트 루트에서 실행
cd /home/nosky/macro
python3 main.py

# 또는 (경로 문제가 있을 경우)
python3 test_app.py
```

## 📋 주요 기능

### 1. Excel 탭
- **파일 선택**: Excel 파일을 드래그 앤 드롭 또는 찾아보기로 선택
- **시트 선택**: 드롭다운에서 작업할 시트 선택
- **열 매핑**: 각 열의 데이터 타입 자동 감지
- **미리보기**: 선택한 데이터의 처음 10행 표시
- **상태 열**: 작업 완료 상태를 기록할 열 자동 감지/생성

### 2. Editor 탭 (매크로 편집기)
- **드래그 앤 드롭**: 왼쪽 팔레트에서 단계를 드래그하여 추가
- **지원되는 단계 타입**:
  - 🖱️ 마우스 클릭/이동
  - ⌨️ 텍스트 입력/단축키
  - ⏱️ 대기 시간
  - 🖼️ 이미지 대기/검색
  - 📷 화면 캡처
  - ❓ 조건문 (구현 예정)
  - 🔄 반복문 (구현 예정)
- **단계 편집**: 각 단계 더블클릭으로 상세 설정
- **변수 사용**: {{column_name}} 형식으로 Excel 데이터 참조

### 3. Run 탭 (실행)
- **실행 제어**: 시작/일시정지/정지 버튼
- **핫키 지원**: 
  - F9: 일시정지/재개
  - ESC: 정지
- **진행 상태**: 실시간 진행률 표시
- **실행 로그**: 각 단계별 성공/실패 기록
- **옵션**: 미완료 항목만 실행 체크박스

## 🎯 사용 시나리오

### 시나리오 1: 반복적인 데이터 입력
1. Excel 파일에 입력할 데이터 목록 준비
2. 매크로 편집기에서 다음 단계 구성:
   - 마우스 클릭 (입력 필드 위치)
   - 텍스트 입력 ({{이름}} 변수 사용)
   - 대기 (0.5초)
   - 다음 필드로 이동...
3. 실행하면 Excel의 각 행마다 자동 입력

### 시나리오 2: 이미지 기반 자동화
1. 이미지 대기 단계 추가
2. "Capture" 버튼으로 대상 이미지 캡처
3. ROI(관심 영역) 설정으로 검색 범위 제한
4. 이미지가 나타나면 다음 동작 수행

## ⚠️ 주의사항

### 현재 상태
- ✅ 기본 자동화 기능 구현 완료
- ✅ 이미지 인식 (OpenCV) 구현 완료
- ❌ OCR 텍스트 인식 미구현
- ❌ 조건문/반복문 실제 동작 미구현
- ❌ 매크로 저장/불러오기 미구현

### 실행 환경
- GUI 환경 필요 (X11, Wayland 등)
- 관리자 권한 불필요
- Python 3.8+ 필요

## 🔧 문제 해결

### 1. ImportError 발생 시
```bash
# 프로젝트 루트에서 실행 확인
cd /home/nosky/macro
export PYTHONPATH=$PWD/src:$PYTHONPATH
python3 main.py
```

### 2. Qt 플랫폼 에러
```bash
# Linux에서 X11 forwarding 필요
export DISPLAY=:0
# 또는 SSH의 경우
ssh -X user@host
```

### 3. 의존성 문제
```bash
# 개별 패키지 재설치
pip3 install --upgrade PyQt5
pip3 install --upgrade opencv-python
```

## 📝 다음 단계

1. **OCR 기능 구현** (T-006)
   - EasyOCR을 사용한 동적 텍스트 검색
   - Excel 데이터 기반 텍스트 찾기 및 클릭

2. **조건문 구현** (T-007)
   - If-Then-Else 로직
   - 이미지/텍스트 존재 여부 판단

3. **매크로 저장/불러오기** (T-008)
   - JSON 형식으로 매크로 저장
   - 재사용 가능한 매크로 라이브러리

4. **고급 로깅** (T-009)
   - CSV 형식 실행 로그
   - 오류 스크린샷 자동 저장