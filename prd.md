# 제품 요구사항 문서(PRD)  
엑셀 기반 작업 자동화 매크로 데스크탑 앱  

## 1. 개요  
본 데스크탑 앱은 엑셀(Excel) 파일의 작업 목록을 기반으로 사용자가 정의한 순서대로 마우스·키보드·화면 인식 동작을 자동 수행하고 완료 여부를 표시한다. 비개발자 의료인이 반복적인 컴퓨터 작업을 코드 작성 없이 자동화하여 업무 효율을 극대화할 수 있도록 직관적 GUI를 제공한다.

## 2. 문제 정의  
- 의료 현장·사무실의 반복적 전산 업무(환자 정보 입력, 보고서 업로드 등)는 수작업 시간이 길고 오류 발생률이 높음.  
- 병원 전산팀 지원을 받지 못하는 개인·소규모 기관은 별도 자동화 솔루션 도입이 어려움.  
- 엑셀에 정리된 작업 목록을 바탕으로 자동화하려 해도 RPA·매크로 툴은 복잡한 스크립트 작성이 필요.  

## 3. 목표 및 지표  
- 1차 목표: 엑셀→GUI 구성→매크로 실행까지 30분 이내 달성(비개발자 기준).  
- 2차 목표: 수작업 대비 업무 시간 50% 이상 단축, 오류 90% 이상 감소.  
- 성공 지표  
  - Onboarding 완료 시간 ≤30분 사용자 비율 80%  
  - 월간 활성 사용자(MAU) ≥500 의료인  
  - 작업당 평균 소요 시간 50%↓  
  - 자동화 실패율 ≤5%  

## 4. 대상 사용자  
### 주요 사용자  
- 직군: 간호사·의무기록사·의사·행정원  
- 특성: 코딩 지식 없음, 엑셀 사용 능숙, 반복입력·업로드 업무 빈번  
- 니즈: 클릭·키 입력 자동화, 상태 확인, 오류 최소화  

### 부수 사용자  
- 병원 IT 담당자(배포·패키징)  
- 컨설턴트(RPA PoC)  

## 5. 사용자 스토리  
- “간호사로서 환자 100명의 검사 결과를 병원 포털에 등록하려고 엑셀 목록을 불러와 클릭·입력을 자동화하여 시간을 절약하고 싶다.”  
- “의무기록사로서 완료되지 않은 행만 재실행해 누락 없이 기록을 마감하고 싶다.”  
- “행정원으로서 특정 버튼 이미지가 나타나야 다음 단계로 진행하도록 조건부 로직을 설정하고 싶다.”  

## 6. 기능 요구사항  
### 6.1 핵심 기능  
1. 엑셀 연동  
   - 파일 선택 후 시트·열 매핑 UI 제공  
   - 지정 열의 데이터 미리보기 및 타입 검증  
   - 실행 후 상태 열 자동 업데이트(완료/실패/사용자 정의 텍스트)  
   - 수락 기준: 잘못된 경로·시트 지정 시 오류 알림, 상태 열이 없는 경우 자동 생성  

2. GUI 기반 작업 편집기  
   - Drag & Drop 방식 단계 편집 패널  
   - 지원 동작  
     ① 마우스: 이동·클릭·더블클릭·드래그  
     ② 키보드: 텍스트·특수키·단축키(조합)  
③ 화면 인식: 이미지 서치(OpenCV), OCR(EasyOCR)
④ 동적 텍스트 검색 및 클릭(Dynamic Text Search & Click)
   - 간편한 화면 영역 설정: 사용자가 '영역 지정' 버튼을 누르면, 화면이 반투명하게 변하며 마우스로 드래그하여 검색할 사각형 영역을 손쉽게 지정할 수 있음(화면 캡처 도구처럼)
   - 지정된 영역의 좌표는 작업 단계에 자동으로 저장
   - 엑셀 데이터 기반 텍스트 검색 및 클릭: 사용자는 작업 흐름에 "동적 텍스트 찾기" 단계를 추가할 수 있음
   - 이 단계에서 엑셀의 특정 열(e.g., '이름' 또는 '병력번호' 열)을 지정
   - 매크로 실행 시, 프로그램은 미리 지정된 화면 영역 안에서 현재 작업 순서에 해당하는 엑셀의 텍스트(e.g., "홍길동")를 OCR(EasyOCR)로 찾아냄
   - 해당 텍스트를 찾으면 그 좌표를 자동으로 클릭하거나, 다음 동작의 기준점으로 사용
⑤ 흐름 제어: Delay·Loop·If(조건)
   - 엑셀 변수 바인딩(예: {{이름}}) 템플릿 지원  
   - 실시간 미리보기·테스트 실행  
   - 수락 기준: 단계 추가·삭제·순서변경이 3클릭 이내, 미리보기 오류율 ≤5%  

3. 매크로 실행/제어  
   - 행 단위 순차 실행, “미완료만 실행” 옵션  
   - 일시정지·강제종료 핫키(기본 F9, Esc)  
   - 실행 로그: 행 번호, 단계, 성공/실패, 소요시간(ms) CSV 저장  
   - 수락 기준: 10,000행 처리 시 메모리 누수 없이 완료  

### 6.2 보조 기능  
- 작업 템플릿 갤러리(로그인 불필요, 로컬 저장)  
- 다국어 UI(한국어 기본, 영어 선택)  
- 자동 업데이트 체크  
- 다크모드  

### 6.3 Nice-to-Have 제안  
- 음성 명령으로 매크로 시작/정지  
- 작업 스케줄러(특정 시간에 자동 실행)  
- 클라우드 동기화로 여러 PC 설정 공유  
- 오류 발생 시 스크린샷 자동 첨부 리포트  

## 7. 비기능 요구사항  
- 성능: 1단계 실행 응답 ≤300ms, 500단계/행 처리 시 CPU 사용률 50%↓  
- 보안: 로컬 파일·스크립트 암호화 저장(AES-256), 네트워크 전송 없음 기본  
- 사용성: 온보딩 튜토리얼 5분, UI 접근성 WCAG 2.1 AA  
- 확장성: 플러그인 아키텍처로 새 동작 타입 추가 가능  
- 호환성: Windows 10/11 64bit, 해상도 1280×720 이상  

## 8. 기술 고려사항  
- 언어: Python 3.8+  
- GUI: PyQt5(권장), Fallback Tkinter  
- 자동화: PyAutoGUI  
- 이미지: OpenCV 4.x  
- OCR: EasyOCR
- 엑셀: pandas, openpyxl  
- 패키징: PyInstaller(onefile)  
- 구조: MVC 패턴, 작업 단계는 JSON 정의 저장
- 멀티/싱글 모니터 환경 자동 인식 및 주 모니터 기준 동작 보장
- 통합: 병원 사내망 제한 환경 고려, 인터넷 필요 없음  

## 9. 성공 지표  
- 기능 지표: 매크로 완료율 ≥95%, 로그 오류율 ≤2%  
- 사용자 지표: NPS≥50, 재방문률 70%  
- 비즈니스 지표: 라이선스 업셀 비율 20%  
- 기술 지표: 평균 메모리 사용량 ≤500MB, 크래시 0.1/세션↓  

## 10. 일정 및 마일스톤  
- 1단계(MVP, 3개월)  
  - 엑셀 불러오기, 마우스·키보드 동작, 순차 실행, 상태 업데이트  
- 2단계(고도화, +2개월)  
  - 이미지 서치, OCR, 조건·반복, 로그 뷰어  
- 3단계(확장, +2개월)  
  - 템플릿 갤러리, 다국어, 자동 업데이트, 다크모드  
- 4단계(NTH, +3개월)  
  - 음성 명령, 스케줄러, 클라우드 싱크  

## 11. 위험 및 완화  
- 기술: 화면 해상도 및 멀티/싱글 모니터 환경에서 이미지 매칭·마우스 위치 오류 발생 가능 → DPI 스케일 보정 알고리즘 및 멀티 모니터 탐지, 좌표 일치 로직 적용
- 비즈니스: 의료기관 보안 정책으로 실행 파일 차단 → 오프라인 설치 패키지·서명 배포  
- 사용자: 비개발자 혼란 → 인앱 가이드·툴팁·영상 제공  

## 12. 향후 고려사항  
- Mac·리눅스 버전  
- AI 기반 자동 단계 추천(사용 패턴 학습)  
- HIPAA·GDPR 등 의료 데이터 규정 준수 모듈  
- SaaS RPA 연계 API 공개  

(문서 길이: 약 4,100자)