# 제품 요구사항 문서: Excel 매크로 자동화

## 제품 개요

### 문서 정보
- **제목**: Excel 매크로 자동화 PRD
- **버전**: 2.0.0
- **날짜**: 2025년 1월
- **상태**: 활성

### 제품 요약
Excel 매크로 자동화는 Excel 파일에서 데이터를 읽고 화면 자동화 시퀀스를 실행하여 반복적인 작업을 자동화하는 Windows 데스크톱 애플리케이션입니다. PyQt5로 구축되어 프로그래밍 지식 없이도 비기술 사용자가 복잡한 자동화 워크플로우를 만들 수 있는 직관적인 시각적 드래그 앤 드롭 매크로 편집기를 제공합니다. 이 애플리케이션은 Excel 데이터와 화면 기반 반복 작업 간의 격차를 해소하여 데이터 입력 및 처리 워크플로우에서 수동 노력과 인적 오류를 크게 줄입니다.

## 목표

### 비즈니스 목표
- 반복적인 Excel 기반 워크플로우의 수동 데이터 입력 시간을 80% 감소
- Excel과 다른 애플리케이션 간의 데이터 전송에서 인적 오류 제거
- 비기술 직원이 자체 자동화 워크플로우를 만들고 유지 관리할 수 있도록 지원
- 중소기업을 위한 엔터프라이즈 RPA 솔루션의 비용 효율적인 대안 제공
- 일상적인 화면 기반 작업을 자동화하여 전반적인 생산성 향상

### 사용자 목표
- 프로그래밍 지식 없이 자동화 워크플로우 생성
- Excel에서 웹 양식이나 데스크톱 애플리케이션으로의 반복적인 데이터 입력 자동화
- 최소한의 수동 개입으로 대규모 Excel 데이터셋을 효율적으로 처리
- 오류를 우아하게 처리하는 신뢰할 수 있는 매크로 구축
- 팀 구성원과 자동화 워크플로우 저장 및 공유

### 비목표
- 여러 자동화 인스턴스의 전사적 오케스트레이션
- 클라우드 기반 실행 또는 원격 자동화
- 웹 스크래핑 또는 API 통합
- 모바일 애플리케이션 자동화
- 크로스 플랫폼 지원 (현재 Windows 전용)

## 사용자 페르소나

### 주요 사용자: 데이터 입력 전문가
- **연령**: 25-45세
- **기술 수준**: 기본에서 중급 컴퓨터 기술
- **역할**: 매일 Excel 데이터 처리, 다양한 시스템에 정보 입력
- **문제점**: 반복적인 수동 데이터 입력, 오류 발생 가능성, 시간 소모적인 작업
- **필요사항**: 반복 작업을 자동화하는 간단한 방법, 실행 중 시각적 피드백

### 보조 사용자: 사무실 관리자
- **연령**: 30-55세
- **기술 수준**: 중급 컴퓨터 기술
- **역할**: 사무실 워크플로우 관리, 보고서 작성, 양식 처리
- **문제점**: 여러 시스템이 동일한 데이터 요구, 수동 복사-붙여넣기 워크플로우
- **필요사항**: 신뢰할 수 있는 자동화, 오류 처리, 워크플로우 수정 기능

### 제3 사용자: 소상공인
- **연령**: 35-60세
- **기술 수준**: 다양함
- **역할**: 비즈니스 운영 감독, 효율성 개선 추구
- **문제점**: 자동화 도구에 대한 제한된 예산, 반복 작업에 낭비되는 직원 시간
- **필요사항**: 저렴한 자동화 솔루션, 구현 및 유지 관리 용이

### 역할 기반 액세스
- **일반 사용자**: 매크로 생성, 편집 및 실행
- **파워 사용자**: OCR 구성 및 사용자 정의 스크립트와 같은 고급 기능 액세스
- **관리자**: 애플리케이션 설정, 암호화 키 및 사용자 기본 설정 관리

## 기능 요구사항

### 높은 우선순위 (P0)
- Excel 파일 로드 및 시트/열 매핑
- 시각적 드래그 앤 드롭 매크로 편집기
- 기본 자동화 단계 (마우스 클릭, 키보드 입력, 대기)
- 진행 상황 추적이 있는 매크로 실행
- 오류 처리 및 복구 옵션
- 암호화된 매크로 파일 저장/로드
- Excel 데이터에서 변수 대체

### 중간 우선순위 (P1)
- 이미지 기반 요소 감지
- OCR 텍스트 인식 및 검색
- 조건부 논리 (if-then-else)
- 행 반복을 위한 Excel 워크플로우 블록
- 다국어 지원 (영어, 한국어)
- 실행 로깅 및 보고
- 실행 중 단축키 제어

### 낮은 우선순위 (P2)
- 신뢰도 수준이 있는 고급 이미지 매칭
- 사용자 정의 루프 구성
- 실행 중 스크린샷 캡처
- 플로팅 상태 위젯
- 시스템 트레이 통합
- 인간과 같은 마우스 움직임 시뮬레이션
- AES-256으로 매크로 파일 암호화

## 사용자 경험

### 진입점
- 데스크톱 바로 가기 또는 시작 메뉴 실행
- 시스템 트레이 아이콘 (최소화 시)
- .emf (암호화된 매크로 파일) 확장자와 파일 연결
- 자동화를 위한 명령줄 실행

### 핵심 경험
1. **Excel 설정**: 사용자가 Excel 파일을 로드하고, 시트를 선택하고, 열을 매핑
2. **매크로 생성**: 팔레트에서 드래그 앤 드롭으로 워크플로우 생성
3. **구성**: 시각적 대화 상자로 각 단계 구성
4. **테스트**: 개별 단계 미리보기 및 테스트
5. **실행**: 실시간 진행 상황 피드백으로 매크로 실행
6. **결과**: 실행 보고서 및 Excel 상태 업데이트 보기

### 고급 기능
- **Excel 워크플로우 블록**: 여러 행 처리를 위한 반복 범위 정의
- **동적 텍스트 검색**: 변수 대체가 있는 OCR 기반 텍스트 감지
- **조건부 실행**: 이미지/텍스트 존재 여부에 따른 if-then-else 논리
- **오류 복구**: 단계별로 구성 가능한 재시도 및 오류 처리
- **변수 시스템**: Excel 열 데이터를 모든 텍스트 필드에서 변수로 사용

### UI/UX 하이라이트
- 명확한 워크플로우 분리를 위한 3탭 인터페이스 (Excel, 편집기, 실행)
- 아이콘과 설명이 있는 시각적 단계 팔레트
- 시각적 피드백이 있는 드래그 앤 드롭 재정렬
- 실시간 유효성 검사 및 오류 강조 표시
- 실행 중 진행 상황 시각화
- 상황별 도움말 및 툴팁

## 내러티브
의료 클리닉의 데이터 입력 전문가인 Sarah는 Excel 매크로 자동화를 열어 하루를 시작합니다. 그녀는 환자 예약 스프레드시트를 로드하고 환자 이름, ID 및 예약 시간 열을 빠르게 매핑합니다. 시각적 편집기를 사용하여 클리닉의 스케줄링 시스템을 열고, ID로 각 환자를 검색하고, 예약 시간을 업데이트하는 단계를 드래그합니다. 그녀는 다른 화면 상태를 처리하기 위해 이미지 인식 단계를 추가하고 누락된 환자에 대한 오류 처리를 포함합니다. 몇 행으로 테스트한 후, 그녀는 200개의 모든 예약에 대해 매크로를 실행하고, 도구가 각 행을 자동으로 처리하고 완료 상태로 Excel 파일을 업데이트하는 동안 진행률 표시줄을 봅니다. 3시간이 걸렸던 작업이 이제 20분 만에 완료되며, 자동화가 백그라운드에서 실행되는 동안 그녀는 더 의미 있는 환자 치료 작업에 집중할 수 있습니다.

## 성공 지표

### 사용자 중심 지표
- 작업 완료 시간 감소: >75%
- 오류율 감소: >90%
- 사용자 만족도 점수: >4.5/5
- 첫 번째 매크로 생성 시간: <30분
- 성공적인 매크로 실행률: >95%

### 비즈니스 지표
- 월별 활성 사용자 수
- 사용자당 평균 생성 매크로 수
- 절약된 총 자동화 시간
- 시간 절약을 통한 ROI
- 사용자 유지율: >80%

### 기술 지표
- 애플리케이션 시작 시간: <3초
- 단계 실행 정확도: >99%
- 실행 중 메모리 사용량: <500MB
- 충돌률: <0.1%
- OCR 정확도: 표준 글꼴에서 >95%

## 기술적 고려사항

### 통합 지점
- 화면 캡처 및 입력 시뮬레이션을 위한 Windows OS API
- 크로스 애플리케이션 자동화를 위한 PyAutoGUI
- pandas/openpyxl을 통한 Excel 파일 형식
- 텍스트 인식을 위한 PaddleOCR
- 이미지 매칭을 위한 OpenCV (선택 사항)

### 데이터 저장소/개인정보 보호
- 로컬 전용 데이터 저장소 (클라우드 연결 없음)
- 저장된 매크로 파일에 대한 AES-256 암호화
- 사용자별 암호화 키
- 애플리케이션에 자격 증명 저장 안 함
- 로그에서 민감한 데이터 마스킹

### 확장성/성능
- 최대 10,000행의 Excel 파일 처리
- 멀티 모니터 설정 지원
- DPI 스케일링 인식
- 대규모 데이터셋을 위한 청크 처리
- 비차단 UI를 위한 스레딩

### 잠재적 과제
- 화면 해상도 종속성
- 이미지 인식을 깨뜨리는 애플리케이션 UI 변경
- 비표준 글꼴에서의 OCR 정확도
- 구형 하드웨어에서의 성능
- 자동화 방지 소프트웨어 감지

## 마일스톤 및 순서

### 프로젝트 예상
- 총 개발 시간: 6개월
- 유지 보수 및 업데이트: 지속적

### 팀 규모
- 개발자 2명 (시니어 1명, 중급 1명)
- UI/UX 디자이너 1명 (파트타임)
- QA 엔지니어 1명 (파트타임)
- 기술 작가 1명 (계약직)

### 제안된 단계

#### 1단계: 핵심 기반 (2개월)
- 3개 탭이 있는 기본 UI 프레임워크
- Excel 파일 로드 및 파싱
- 기본 단계가 있는 간단한 매크로 편집기
- 마우스 및 키보드 자동화
- 저장/로드 기능

#### 2단계: 고급 기능 (2개월)
- 이미지 인식 통합
- OCR 텍스트 검색 기능
- 조건부 논리 구현
- Excel 워크플로우 블록
- 오류 처리 시스템

#### 3단계: 다듬기 및 최적화 (1개월)
- UI/UX 개선
- 성능 최적화
- 다국어 지원
- 문서 및 도움말 시스템
- 설치 프로그램 생성

#### 4단계: 향상된 기능 (1개월)
- 플로팅 상태 위젯
- 시스템 트레이 통합
- 고급 보고
- 암호화 구현
- 베타 테스트 및 버그 수정

## 사용자 스토리

### 핵심 기능
**US-001**: Excel 파일 로드
- **제목**: 사용자가 자동화를 위해 Excel 파일을 로드
- **설명**: 사용자로서 자동화 워크플로우에서 데이터를 사용할 수 있도록 Excel 파일을 로드하고 싶습니다
- **승인 기준**:
  - 사용자가 Excel 파일(.xlsx, .xls)을 찾아서 선택할 수 있음
  - 애플리케이션이 파일의 모든 시트를 표시
  - 사용자가 작업할 특정 시트를 선택할 수 있음
  - 열 헤더가 자동으로 감지되고 표시됨
  - 빠른 다시 로드를 위해 파일 경로가 기억됨

**US-002**: Excel 열 매핑
- **제목**: 사용자가 Excel 열을 변수에 매핑
- **설명**: 사용자로서 매크로 단계에서 데이터를 사용할 수 있도록 Excel 열을 명명된 변수에 매핑하고 싶습니다
- **승인 기준**:
  - 선택한 시트의 모든 열이 표시됨
  - 사용자가 열에 친숙한 이름을 할당할 수 있음
  - 시스템이 열 매핑을 검증
  - 매핑이 매크로와 함께 저장됨
  - 미리보기가 매핑된 열의 샘플 데이터를 표시

**US-003**: 기본 마우스 클릭 단계 생성
- **제목**: 사용자가 마우스 클릭 자동화 단계를 생성
- **설명**: 사용자로서 화면 요소 클릭을 자동화할 수 있도록 마우스 클릭 단계를 생성하고 싶습니다
- **승인 기준**:
  - 사용자가 클릭 좌표를 캡처할 수 있음
  - 미리보기가 클릭 위치를 표시
  - 사용자가 클릭 유형(단일/더블/오른쪽)을 설정할 수 있음
  - 사용자가 클릭 동작을 테스트할 수 있음
  - 클릭 좌표가 다른 화면 해상도에서 작동

**US-004**: 키보드 입력 단계 생성
- **제목**: 사용자가 키보드 입력 단계를 생성
- **설명**: 사용자로서 텍스트 입력을 자동화할 수 있도록 키보드 입력 단계를 생성하고 싶습니다
- **승인 기준**:
  - 사용자가 입력할 텍스트를 입력할 수 있음
  - Excel에서 변수 대체 지원
  - 사용자가 입력 속도를 설정할 수 있음
  - 특수 키 지원 (Tab, Enter 등)
  - 미리보기가 변수가 해결된 텍스트를 표시

**US-005**: 매크로 실행
- **제목**: 사용자가 전체 매크로를 실행
- **설명**: 사용자로서 모든 정의된 단계를 통해 자동화가 실행되도록 매크로를 실행하고 싶습니다
- **승인 기준**:
  - 실행을 시작하는 명확한 시작 버튼
  - 실시간 진행률 표시기
  - 현재 단계 강조 표시
  - 일시 중지/중지 제어 사용 가능
  - 실행이 성공적으로 완료됨

### Excel 통합
**US-006**: 여러 Excel 행 처리
- **제목**: 사용자가 여러 Excel 행을 순차적으로 처리
- **설명**: 사용자로서 전체 데이터셋에 대해 반복적인 작업을 자동화할 수 있도록 Excel 파일에서 여러 행을 처리하고 싶습니다
- **승인 기준**:
  - 사용자가 처리할 행을 선택할 수 있음
  - 각 행의 데이터가 변수로 사용 가능
  - 진행률이 처리 중인 현재 행을 표시
  - 실패한 행이 Excel에 표시됨
  - 완료된 행이 성공 상태를 표시

**US-007**: Excel 워크플로우 블록
- **제목**: 사용자가 Excel 워크플로우 블록을 생성
- **설명**: 사용자로서 각 행에 대해 반복되는 단계를 제어할 수 있도록 Excel 행 처리의 시작과 끝을 정의하고 싶습니다
- **승인 기준**:
  - 팔레트에서 Excel 시작/종료 블록 드래그
  - 블록 사이의 단계가 각 행에 대해 반복됨
  - 행 선택 구성 가능 (모두/미완료/범위)
  - 블록 경계의 시각적 표시
  - 중첩된 블록 방지

**US-008**: Excel 상태 업데이트
- **제목**: 시스템이 Excel 행 상태를 업데이트
- **설명**: 사용자로서 진행 상황을 추적할 수 있도록 시스템이 완료 상태로 Excel 행을 업데이트하기를 원합니다
- **승인 기준**:
  - 상태 열이 누락된 경우 자동으로 추가됨
  - 각 행이 처리 후 완료 상태를 표시
  - 실패한 행이 오류 정보를 표시
  - 사용자가 실패한 행만 다시 실행할 수 있음
  - 상태가 세션 간에 유지됨

### 고급 자동화
**US-009**: 이미지 인식 클릭
- **제목**: 사용자가 이미지 인식을 기반으로 클릭
- **설명**: 사용자로서 동적 인터페이스를 자동화할 수 있도록 이미지 매칭으로 식별된 요소를 클릭하고 싶습니다
- **승인 기준**:
  - 사용자가 참조 이미지를 캡처할 수 있음
  - 시스템이 화면에서 일치하는 이미지를 찾음
  - 신뢰도 임계값 구성 가능
  - 이미지 중심 또는 오프셋에서 클릭 발생
  - 이미지를 찾을 수 없을 때 오류 처리

**US-010**: OCR 텍스트 검색
- **제목**: 사용자가 OCR을 사용하여 텍스트를 검색하고 클릭
- **설명**: 사용자로서 텍스트 기반 인터페이스를 자동화할 수 있도록 OCR을 사용하여 텍스트 요소를 찾고 클릭하고 싶습니다
- **승인 기준**:
  - 사용자가 검색 텍스트를 정의하거나 Excel 변수를 사용할 수 있음
  - OCR이 지정된 화면 영역에서 실행됨
  - 찾은 텍스트가 미리보기에서 강조 표시됨
  - 사용자가 찾은 텍스트를 클릭할 수 있음
  - 부분 텍스트 일치 처리

**US-011**: 조건부 실행
- **제목**: 사용자가 조건부 논리를 생성
- **설명**: 사용자로서 매크로가 다른 시나리오를 처리할 수 있도록 if-then-else 논리를 생성하고 싶습니다
- **승인 기준**:
  - 사용자가 조건을 설정할 수 있음 (이미지 존재, 텍스트 존재 등)
  - 참 및 거짓 분기가 명확하게 표시됨
  - 각 분기에 단계를 추가할 수 있음
  - 조건이 Excel 변수를 사용할 수 있음
  - 시각적 흐름도가 논리를 표시

**US-012**: 대기 조건
- **제목**: 사용자가 동적 대기 조건을 추가
- **설명**: 사용자로서 매크로가 타이밍 문제를 처리할 수 있도록 특정 조건을 기다리고 싶습니다
- **승인 기준**:
  - 고정 시간 동안 대기
  - 이미지가 나타날 때까지 대기
  - 텍스트가 나타날 때까지 대기
  - 구성 가능한 타임아웃 값
  - 대기 중 명확한 표시

### 오류 처리
**US-013**: 단계별 오류 처리 구성
- **제목**: 사용자가 단계별로 오류 처리를 구성
- **설명**: 사용자로서 매크로가 탄력적이 되도록 각 단계가 오류를 처리하는 방법을 구성하고 싶습니다
- **승인 기준**:
  - 각 단계에 오류 처리 옵션이 있음
  - 옵션에는 중지, 계속, 재시도가 포함됨
  - 재시도 횟수 구성 가능
  - 오류 세부 정보가 로그됨
  - 사용자가 전역 오류 기본값을 설정할 수 있음

**US-014**: 실행 로그 보기
- **제목**: 사용자가 상세한 실행 로그를 봄
- **설명**: 사용자로서 문제를 디버그하고 성공적인 실행을 확인할 수 있도록 실행 로그를 보고 싶습니다
- **승인 기준**:
  - 로그가 각 단계의 타임스탬프를 표시
  - 성공/실패 상태가 명확함
  - 오류 메시지가 설명적임
  - 로그를 날짜/상태별로 필터링할 수 있음
  - 파일로 로그 내보내기 옵션

### 파일 관리
**US-015**: 매크로 파일 저장
- **제목**: 사용자가 매크로 구성을 저장
- **설명**: 사용자로서 나중에 재사용할 수 있도록 매크로를 저장하고 싶습니다
- **승인 기준**:
  - 이름과 설명이 있는 저장 대화 상자
  - 보안을 위해 파일이 암호화됨
  - 덮어쓰기에 확인 필요
  - 최근 파일 목록이 업데이트됨
  - 저장 위치 구성 가능

**US-016**: 매크로 파일 로드
- **제목**: 사용자가 저장된 매크로를 로드
- **설명**: 사용자로서 실행하거나 수정할 수 있도록 이전에 저장한 매크로를 로드하고 싶습니다
- **승인 기준**:
  - 파일 브라우저가 .emf 파일을 표시
  - 매크로가 모든 설정이 그대로 로드됨
  - Excel 파일 경로가 검증됨
  - 누락된 Excel 열이 강조 표시됨
  - 사용자가 파일 경로를 업데이트할 수 있음

### 보안
**US-017**: 안전한 매크로 저장소
- **제목**: 시스템이 매크로 파일을 암호화
- **설명**: 사용자로서 민감한 정보가 보호되도록 매크로 파일이 암호화되기를 원합니다
- **승인 기준**:
  - 파일이 AES-256 암호화 사용
  - 암호화가 사용자에게 투명함
  - 손상된 파일이 명확한 오류를 표시
  - 파일에 비밀번호 저장 안 함
  - 각 사용자가 고유한 암호화 키를 가짐

### UI/UX 기능
**US-018**: 드래그 앤 드롭 편집기
- **제목**: 사용자가 드래그 앤 드롭으로 단계를 정렬
- **설명**: 사용자로서 매크로를 쉽게 만들고 수정할 수 있도록 단계를 드래그 앤 드롭하고 싶습니다
- **승인 기준**:
  - 팔레트에서 단계를 드래그할 수 있음
  - 드롭 영역이 명확하게 표시됨
  - 드래그로 단계 순서를 변경할 수 있음
  - 잘못된 드롭이 방지됨
  - 실행 취소/다시 실행 지원

**US-019**: 시각적 단계 구성
- **제목**: 사용자가 대화 상자를 통해 단계를 구성
- **설명**: 사용자로서 설정이 직관적이 되도록 단계 구성을 위한 시각적 대화 상자를 원합니다
- **승인 기준**:
  - 더블 클릭으로 구성 열림
  - 모든 옵션에 명확한 레이블이 있음
  - 도움말 텍스트가 각 옵션을 설명
  - 미리보기가 구성 효과를 표시
  - 유효성 검사가 잘못된 설정을 방지

**US-020**: 다국어 지원
- **제목**: 사용자가 인터페이스 언어를 선택
- **설명**: 사용자로서 선호하는 언어로 애플리케이션을 사용하고 싶습니다
- **승인 기준**:
  - 설정에서 언어 선택
  - 모든 UI 텍스트가 번역됨
  - 현재 영어와 한국어 지원
  - 언어 변경이 즉시 적용됨
  - 날짜/숫자 형식이 로케일을 따름

### 실행 제어
**US-021**: 실행 일시 중지 및 재개
- **제목**: 사용자가 매크로 실행을 일시 중지하고 재개
- **설명**: 사용자로서 예상치 못한 상황을 처리할 수 있도록 실행을 일시 중지하고 싶습니다
- **승인 기준**:
  - 단축키(F9)가 실행을 일시 중지
  - 일시 중지된 상태의 시각적 표시
  - 재개가 일시 중지된 단계에서 계속됨
  - 일시 중지 시 UI가 응답 상태 유지
  - 일시 중지 중 매크로 수정 가능

**US-022**: 긴급 중지
- **제목**: 사용자가 긴급 중지를 수행
- **설명**: 사용자로서 문제가 있는 실행을 즉시 중지할 수 있도록 긴급 중지 기능을 원합니다
- **승인 기준**:
  - ESC 키가 즉시 실행을 중지
  - 마우스를 모서리로 이동하면 페일세이프 트리거
  - 중지의 명확한 확인
  - 부분 결과가 보존됨
  - 마지막 성공한 단계에서 재개 가능

### 모니터링
**US-023**: 플로팅 상태 위젯
- **제목**: 사용자가 플로팅 위젯을 통해 실행을 모니터링
- **설명**: 사용자로서 다른 애플리케이션을 사용하는 동안 진행 상황을 모니터링할 수 있도록 플로팅 상태 위젯을 원합니다
- **승인 기준**:
  - 위젯이 현재 단계와 진행률을 표시
  - 항상 위 옵션
  - 최소/일반/상세 보기 모드
  - 비활성 시 클릭 통과
  - 완료 후 자동 숨김

**US-024**: 시스템 트레이 통합
- **제목**: 애플리케이션이 시스템 트레이에서 실행
- **설명**: 사용자로서 애플리케이션이 작업 표시줄을 어지럽히지 않도록 시스템 트레이 통합을 원합니다
- **승인 기준**:
  - 시스템 트레이로 최소화 옵션
  - 트레이 아이콘이 실행 상태를 표시
  - 빠른 작업을 위한 오른쪽 클릭 메뉴
  - 이벤트에 대한 풍선 알림
  - 더블 클릭으로 창 복원

### 인증 및 액세스 제어
**US-025**: 안전한 애플리케이션 액세스
- **제목**: 사용자가 안전하게 애플리케이션에 액세스
- **설명**: 민감한 데이터를 가진 사용자로서 자동화 워크플로우가 보호되도록 애플리케이션에 대한 안전한 액세스를 원합니다
- **승인 기준**:
  - 애플리케이션이 Windows 사용자 인증 필요
  - 암호화 키가 사용자 프로필에 연결됨
  - 로컬 사용에 별도 로그인 필요 없음
  - 설정이 사용자별임
  - 공유 매크로에는 명시적인 파일 공유 필요